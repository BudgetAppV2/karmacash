# [B7.5] Template Exchange System - API Testing Tools

## 1. Introduction

This section documents the tools developed for testing and validating the Template Exchange System API. These tools automate the deployment process and verify that the API functions correctly, ensuring a reliable communication channel between Google AI Studio and Cursor AI.

## 2. Deployment Script

The deployment script (`scripts/deploy.js`) automates the process of deploying the Firebase components required for the Template Exchange System.

### 2.1 Purpose

- Simplify the deployment of Firestore security rules, indexes, and Cloud Functions
- Ensure consistent deployment configuration
- Reduce human error in the deployment process

### 2.2 Usage

```bash
# Deploy everything
node scripts/deploy.js --all

# Deploy specific components
node scripts/deploy.js --rules     # Deploy only Firestore security rules
node scripts/deploy.js --indexes   # Deploy only Firestore indexes
node scripts/deploy.js --functions # Deploy only Cloud Functions
```

### 2.3 Features

- Interactive deployment process with confirmation prompts
- Automatic detection of Firebase project ID from `.firebaserc`
- Dependency installation for Cloud Functions
- Detailed logging with color-coded output
- Error handling and reporting

## 3. API Testing Script

The API testing script (`src/template-exchange/scripts/test-api.js`) provides automated testing for the Template Exchange API endpoints.

### 3.1 Purpose

- Validate API functionality
- Test authentication mechanisms
- Verify CRUD operations
- Test error handling
- Evaluate performance

### 3.2 Usage

```bash
# With environment variables
export API_KEY=your_api_key
export API_URL=https://your-firebase-project.web.app/api
node src/template-exchange/scripts/test-api.js

# Without environment variables (script will prompt for values)
node src/template-exchange/scripts/test-api.js
```

### 3.3 Test Coverage

The script includes 15 test cases covering all aspects of the API:

1. Health check
2. API key validation
3. Template creation (handoff and summary types)
4. Template retrieval by ID and session ID
5. Template listing with filtering
6. Template updating
7. Input validation
8. Pagination
9. Template deletion
10. Sharding strategy validation

### 3.4 Test Reports

The script generates detailed test reports in JSON format, stored in the `src/template-exchange/test-reports` directory. Each report includes:

- Test summaries (total, passed, failed, skipped)
- Detailed test results for each test case
- Request and response data
- Performance metrics
- Timestamps for audit trails

### 3.5 Test Result Interpretation

- **All tests pass**: The API is functioning correctly and ready for integration testing
- **Authentication failures**: API key configuration issues
- **Validation failures**: Schema validation issues
- **CRUD failures**: Database access issues
- **Sharding failures**: Data distribution strategy issues

## 4. API Key Generation Tool

The API key generation script (`src/template-exchange/scripts/create-api-key.js`) creates and stores API keys for authentication.

### 4.1 Purpose

- Generate secure API keys
- Store keys in Firestore for validation
- Provide access to the API for authorized clients

### 4.2 Usage

```bash
node src/template-exchange/scripts/create-api-key.js [path/to/serviceAccountKey.json]
```

### 4.3 Security Considerations

- API keys should be kept confidential
- Keys should be rotated periodically
- Different keys should be used for development and production
- Access should be limited to necessary services

## 5. Manual Testing Guide

For manual testing of the Template Exchange API, refer to the comprehensive guide in [docs/template-exchange-api-testing.md](template-exchange-api-testing.md).

## 6. Integration with Continuous Integration (CI)

The testing scripts are designed to be integrated with CI pipelines:

```yaml
# Example GitHub Actions workflow step
- name: Test API
  run: |
    export API_KEY=${{ secrets.TEMPLATE_API_KEY }}
    export API_URL=${{ secrets.TEMPLATE_API_URL }}
    node src/template-exchange/scripts/test-api.js
```

## 7. Troubleshooting

Common issues and their solutions:

| Issue | Solution |
|-------|----------|
| Authentication failure | Verify API key is correct and properly included in requests |
| Deployment failure | Check Firebase CLI installation and permissions |
| Test script errors | Verify Node.js version (16+ required) |
| Connection timeouts | Check network connectivity and Firebase service status |

## 8. References

- [Firebase Cloud Functions Documentation](https://firebase.google.com/docs/functions)
- [Firebase Firestore Security Rules](https://firebase.google.com/docs/firestore/security/get-started)
- [Firebase CLI Documentation](https://firebase.google.com/docs/cli) 